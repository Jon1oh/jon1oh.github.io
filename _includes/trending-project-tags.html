{% assign MAX = 10 %}

{% assign size_list = '' | split: '' %}
{% assign tag_list = '' | split: '' %}

{% assign project_tags = '' | split: '' %}
{% for project in site.projects %}
  {% assign project_tags = project_tags | concat: project.tags %}
{% endfor %}
{% assign project_tags = project_tags | uniq %}

{% for tag in project_tags %}
  {% assign size = site.projects | where: "tags", tag | size %}
  {% assign size_list = size_list | push: size %}
  {% assign tag_str = tag | append: '::' | append: size %}
  {% assign tag_list = tag_list | push: tag_str %}
{% endfor %}

{% assign size_list = size_list | sort | reverse %}
{% assign tag_list = tag_list | sort_natural %}

{% assign trending_tags = '' | split: '' %}

{% for size in size_list limit: MAX %}
  {% for tag_str in tag_list %}
    {% assign tag = tag_str | split: '::' %}
    {% assign tag_name = tag | first %}
    {% assign tag_size = tag | last | plus: 0 %}
    {% if tag_size == size %}
      {% unless trending_tags contains tag_name %}
        {% assign trending_tags = trending_tags | push: tag_name %}
        {% break %}
      {% endunless %}
    {% endif %}
  {% endfor %}
{% endfor %}

<section>
    <h2 class="panel-heading">Trending Project Tags</h2>
    {% if trending_tags.size > 0 %}
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
        {% for tag_name in trending_tags %}
        {% assign url = tag_name | slugify | url_encode | prepend: '/projects/project_tags/' | append: '/' %}
        <a class="post-tag btn btn-outline-primary" href="{{ url | relative_url }}">{{ tag_name }}</a>
        {% endfor %}
    </div>
    <div>
        <a class="text-muted lh-lg" href="{{ site.baseurl }}/projects/project_tags/">View More</a>
    </div>
    {% else %}
    <div class="mt-3 mb-1 me-3">
        <p>No trending project tags currently available.</p>
    </div>
    {% endif %}
</section>